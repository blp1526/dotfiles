#!/usr/bin/env ruby

if ARGV.size != 1
  puts "Expected ARGV.size is 1, but got #{ARGV.size}."
  exit 1
end

url = ARGV[0]
git_format = /\Agit@(.+?):(.+?)\/(.+?)\.git\z/
https_format = /\Ahttps:\/\/(.+?)\/(.+?)\/(.+?)\.git\z/

[git_format, https_format].each do |format|
  if  url =~ format
    puts "git clone #{url} #{ENV['GOPATH']}/src/#{$1}/#{$2}/#{$3}"
    system("git clone #{url} #{ENV['GOPATH']}/src/#{$1}/#{$2}/#{$3}")
    exit 0
  end
end

puts "Unexpected git clone path, got #{url}."
exit 1
